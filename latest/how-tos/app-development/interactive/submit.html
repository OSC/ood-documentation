

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Job Submission (submit.yml.erb) &mdash; Open OnDemand 3.0.3 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/tabs.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Connection View" href="view.html" />
    <link rel="prev" title="Render Template" href="template.html" />
 
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-34776817-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-34776817-3');
</script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html">
          

          
            
            <img src="../../../_static/logo.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation/add-cluster-config.html">Cluster Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setup Interactive Apps</a></li>
</ul>
<p class="caption"><span class="caption-text">How-Tos</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../customizations.html">Customizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../debug.html">Debugging and Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../enable-desktops.html">Enable Interactive Desktop</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../app-development.html">App Development</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../enabling-development-mode.html">Enabling App Development</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../interactive.html">Interactive Apps</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="manifest.html">Manifest yml files</a></li>
<li class="toctree-l3"><a class="reference internal" href="form.html">User Form (form.yml.erb)</a></li>
<li class="toctree-l3"><a class="reference internal" href="form-widgets.html">Form Widgets</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamic-form-widgets.html">Dynamic Form Widgets</a></li>
<li class="toctree-l3"><a class="reference internal" href="template.html">Render Template</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Job Submission (submit.yml.erb)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#setting-batch-connect-options-globally">Setting Batch Connect Options Globally</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="view.html">Connection View</a></li>
<li class="toctree-l3"><a class="reference internal" href="sub-apps.html">Sub-Apps and Reconfiguring exsting apps</a></li>
<li class="toctree-l3"><a class="reference internal" href="conn-params.html">Connection Parameters <code class="docutils literal notranslate"><span class="pre">conn_params</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../app-sharing.html">App Sharing</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../install-ihpc-apps.html">Install Other Interactive Apps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/tutorials-interactive-apps.html">Tutorials: Interactive Apps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/tutorials-passenger-apps.html">Tutorials: Passenger Apps</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference.html">Configuration Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release-notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../version-policy.html">Versioning Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../issues/overview.html">OnDemand’s Known Issues</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Open OnDemand</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../app-development.html">App Development</a> &raquo;</li>
        
          <li><a href="../interactive.html">Interactive Apps</a> &raquo;</li>
        
      <li>Job Submission (submit.yml.erb)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/OSC/ood-documentation/blob/latest/source/how-tos/app-development/interactive/submit.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="job-submission-submit-yml-erb">
<span id="app-development-interactive-submit"></span><h1>Job Submission (submit.yml.erb)<a class="headerlink" href="#job-submission-submit-yml-erb" title="Permalink to this headline">¶</a></h1>
<p>The configuration file <code class="docutils literal notranslate"><span class="pre">submit.yml.erb</span></code> controls the content of the batch
script as well as the submission arguments used when submitting the batch job.
It is located in the root of the application directory.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This page is an introduction to the <code class="docutils literal notranslate"><span class="pre">submit.yml.erb</span></code>, it’s contents
and it’s use.</p>
<p>Reference documentation holds <a class="reference internal" href="../../../reference/files/submit-yml-erb.html#submit-yml-erb"><span class="std std-ref">all configuration items for submit.yml.erb</span></a>.</p>
</div>
<p>Assuming we already have a sandbox Interactive App deployed under:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>${HOME}/ondemand/dev/my_app
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">submit.yml.erb</span></code> configuration file can be found at:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>${HOME}/ondemand/dev/my_app/submit.yml.erb
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">.erb</span></code> file extension will cause the YAML configuration file to be
processed using the <a class="reference external" href="https://en.wikipedia.org/wiki/ERuby">eRuby (Embedded Ruby)</a> templating system. This allows you
to embed Ruby code into the YAML configuration file for flow control, variable
substitution, and more.</p>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>The three possible configuration options that can be used in the
<code class="docutils literal notranslate"><span class="pre">submit.yml.erb</span></code> file are given as:</p>
<dl class="describe">
<dt>
<code class="sig-name descname">batch_connect (Hash)</code></dt>
<dd><p>The configuration describing the batch script content.
Reference documentation holds <a class="reference internal" href="../../../reference/files/submit-yml-erb.html#submit-yml-erb"><span class="std std-ref">all configuration items for submit.yml.erb</span></a>.</p>
<dl>
<dt>Example</dt><dd><p>Use the default basic web server template</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># ${HOME}/ondemand/dev/my_app/submit.yml.erb</span><span class="w"></span>
<span class="nn">---</span><span class="w"></span>
<span class="nt">batch_connect</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;basic&quot;</span><span class="w"></span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="describe">
<dt>
<code class="sig-name descname">script (Hash)</code></dt>
<dd><p>The configuration describing the job submission parameters for the batch
script. Reference documentation holds
<a class="reference internal" href="../../../reference/files/submit-yml-erb.html#submit-yml-erb"><span class="std std-ref">all configuration items for submit.yml.erb</span></a>.</p>
<dl>
<dt>Example</dt><dd><p>Set the job’s charged account and queue</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># ${HOME}/ondemand/dev/my_app/submit.yml.erb</span><span class="w"></span>
<span class="nn">---</span><span class="w"></span>
<span class="nt">script</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">accounting_id</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;PZS0001&quot;</span><span class="w"></span>
<span class="w">  </span><span class="nt">queue_name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;parallel&quot;</span><span class="w"></span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<span class="target" id="configuring-cluster-in-submit-yml"></span><dl class="describe">
<dt>
<code class="sig-name descname">cluster (String) (Optional)</code></dt>
<dd><p>the cluster to submit to</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Use this field when you need to choose the cluster in
a more dynamic way than <a class="reference internal" href="form.html#configuring-cluster"><span class="std std-ref">what’s provided in the form.</span></a>
Or when you want to choose the cluster for the user given some
choices like the example below.</p>
</div>
<dl>
<dt>Example</dt><dd><p>Submit the job to the the large cluster if requesting more
than 29 cores, else submit to the small cluster.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># ${HOME}/ondemand/dev/my_app/submit.yml.erb</span><span class="w"></span>
<span class="l l-Scalar l-Scalar-Plain">&lt;%-</span><span class="w"></span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">cluster = if num_cores &gt;= 29</span><span class="w"></span>
<span class="w">              </span><span class="l l-Scalar l-Scalar-Plain">&quot;large_cluster&quot;</span><span class="w"></span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">else</span><span class="w"></span>
<span class="w">               </span><span class="l l-Scalar l-Scalar-Plain">&quot;small_cluster&quot;</span><span class="w"></span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">end</span><span class="w"></span>
<span class="l l-Scalar l-Scalar-Plain">-&gt;</span><span class="w"></span>
<span class="nn">---</span><span class="w"></span>
<span class="nt">cluster</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&lt;%=</span><span class="nv"> </span><span class="s">cluster</span><span class="nv"> </span><span class="s">%&gt;&quot;</span><span class="w"></span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<p>Each of these configuration options take a set of their own configuration
options described below.</p>
<div class="section" id="batch-connect-template-types">
<h3>Batch Connect Template types<a class="headerlink" href="#batch-connect-template-types" title="Permalink to this headline">¶</a></h3>
<p>Open OnDemand has three distinct batch connect template types.
These template types determine the resulting shell scripts that wrap
your batch connect application.</p>
<p>For example the <code class="docutils literal notranslate"><span class="pre">vnc</span></code> type will provide a script that boots up a
VNC server, exports a <code class="docutils literal notranslate"><span class="pre">DISPLAY</span></code> variable and other utilities to
ensure that the job has been bootstrapped appropriately to
start GUI applications.</p>
<p>The options available are <code class="docutils literal notranslate"><span class="pre">basic</span></code>, <code class="docutils literal notranslate"><span class="pre">vnc</span></code> or <code class="docutils literal notranslate"><span class="pre">vnc_container</span></code>.
<code class="docutils literal notranslate"><span class="pre">vnc_container</span></code> is basically just like <code class="docutils literal notranslate"><span class="pre">vnc</span></code> only in that it
boostraps the VNC programs inside a container instead of on the
host machine.</p>
<dl class="describe">
<dt>
<code class="sig-name descname">template (String)</code></dt>
<dd><p>The template used to create the wrapper script for your batch connect
application.</p>
<dl>
<dt>Default</dt><dd><p>Generate a basic wrapper script for HTTP applications.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span><span class="w"></span>
<span class="nt">batch_connect</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;basic&quot;</span><span class="w"></span>
</pre></div>
</div>
</dd>
<dt>Example</dt><dd><p>Generate a wrapper script for a VNC interactive application.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># ${HOME}/ondemand/dev/my_app/submit.yml.erb</span><span class="w"></span>
<span class="nn">---</span><span class="w"></span>
<span class="nt">batch_connect</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;vnc&quot;</span><span class="w"></span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<p>Reference documentation holds <a class="reference internal" href="../../../reference/files/submit-yml-erb.html#submit-yml-erb"><span class="std std-ref">all configuration items for submit.yml.erb</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The configuration <code class="docutils literal notranslate"><span class="pre">template:</span> <span class="pre">&quot;vnc&quot;</span></code> comes with more <code class="docutils literal notranslate"><span class="pre">batch_connect</span></code>
configuration options which can be found under the code documentation for
<a class="reference internal" href="../../../reference/files/submit-yml/vnc-bc-options.html#vnc-bc-options"><span class="std std-ref">Batch Connect VNC Options</span></a>.</p>
</div>
</div>
<div class="section" id="configure-script">
<h3>Configure Script<a class="headerlink" href="#configure-script" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">script</span></code> configuration option defines the batch job submission parameters
(e.g., number of nodes, wall time, queue, …). The list of all possible
options can be found under the code documentation for <a class="reference internal" href="../../../reference/files/submit-yml/script.html#submit-script-options"><span class="std std-ref">Batch Connect Script Options</span></a>.</p>
<p>It is recommended to refrain from using the <code class="docutils literal notranslate"><span class="pre">native</span></code> option to best keep your
Interactive App as portable as possible. Although we understand this may not be
possible for all job submission parameters (e.g., number of nodes, memory, GPU)
it would be best to use the respective option corresponding to the submission
parameter if it is available.</p>
<p>For example, if I want to specify the charged account for the job, it is
recommended I use:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># ${HOME}/ondemand/dev/my_app/submit.yml.erb</span><span class="w"></span>
<span class="nn">---</span><span class="w"></span>
<span class="nt">script</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">accounting_id</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;PZS0001&quot;</span><span class="w"></span>
</pre></div>
</div>
<p>as this is resource manager agnostic. But this can also be added for a Slurm
resource manager as:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># ${HOME}/ondemand/dev/my_app/submit.yml.erb</span><span class="w"></span>
<span class="nn">---</span><span class="w"></span>
<span class="nt">script</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">native</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;-A&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;PZS0001&quot;</span><span class="p p-Indicator">]</span><span class="w"></span>
</pre></div>
</div>
<p>but now this app may not work at a center with a different resource manager.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Care must be taken when using the <code class="docutils literal notranslate"><span class="pre">native</span></code> option as this is resource
manager specific. For all supported resource managers (e.g., Slurm, LSF,
PBSPro, …) other than Torque, the <code class="docutils literal notranslate"><span class="pre">native</span></code> option is specified as an
array of command line arguments that are fed to the resource manager’s batch
submission tool (e.g., <strong class="command">sbatch</strong>, <strong class="command">qsub</strong>, <strong class="command">bsub</strong>,
…)</p>
<p>So for Slurm, the following configuration will submit a job to 5 nodes with
feature <code class="docutils literal notranslate"><span class="pre">c12</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># ${HOME}/ondemand/dev/my_app/submit.yml.erb</span><span class="w"></span>
<span class="nn">---</span><span class="w"></span>
<span class="nt">script</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">native</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;-N&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;5&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;-C&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;c12&quot;</span><span class="p p-Indicator">]</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>The simplest example consists of submitting a batch script built from the basic
web server template using all the default options for the cluster’s batch job
submission tool (e.g., <strong class="command">sbatch</strong>, <strong class="command">qsub</strong>, <strong class="command">bsub</strong>,
…).</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># ${HOME}/ondemand/dev/my_app/submit.yml.erb</span><span class="w"></span>
<span class="nn">---</span><span class="w"></span>
<span class="nt">batch_connect</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;basic&quot;</span><span class="w"></span>
</pre></div>
</div>
<div class="section" id="vnc-server">
<h3>VNC Server<a class="headerlink" href="#vnc-server" title="Permalink to this headline">¶</a></h3>
<p>To submit a batch script built from the VNC server template:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># ${HOME}/ondemand/dev/my_app/submit.yml.erb</span><span class="w"></span>
<span class="nn">---</span><span class="w"></span>
<span class="nt">batch_connect</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;vnc&quot;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="change-executable-for-main-script">
<h3>Change Executable for Main Script<a class="headerlink" href="#change-executable-for-main-script" title="Permalink to this headline">¶</a></h3>
<p>When the batch script is rendered from the template, one of the possible
configuration options is specifying the executable command called for the main
script it forks off into the background. This can be configured with:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># ${HOME}/ondemand/dev/my_app/submit.yml.erb</span><span class="w"></span>
<span class="nn">---</span><span class="w"></span>
<span class="nt">batch_connect</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;basic&quot;</span><span class="w"></span>
<span class="w">  </span><span class="nt">script_file</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;./my_custom_script.sh&quot;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="specify-job-submission-parameters">
<h3>Specify Job Submission Parameters<a class="headerlink" href="#specify-job-submission-parameters" title="Permalink to this headline">¶</a></h3>
<p>Cherry-picking some possible options from <a class="reference internal" href="../../../reference/files/submit-yml/script.html#submit-script-options"><span class="std std-ref">Batch Connect Script Options</span></a> gives a batch
job built from the basic web server template submitted with the following
parameters:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># ${HOME}/ondemand/dev/my_app/submit.yml.erb</span><span class="w"></span>
<span class="nn">---</span><span class="w"></span>
<span class="nt">batch_connect</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;basic&quot;</span><span class="w"></span>
<span class="nt">script</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">wall_time</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3600</span><span class="w"></span>
<span class="w">  </span><span class="nt">queue_name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;debug&quot;</span><span class="w"></span>
<span class="w">  </span><span class="nt">email_on_started</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">  </span><span class="nt">job_environment</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">LICENSE_FILE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1234@license.center.edu&quot;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="dynamically-set-submission-parameters">
<h3>Dynamically Set Submission Parameters<a class="headerlink" href="#dynamically-set-submission-parameters" title="Permalink to this headline">¶</a></h3>
<p>Feel free to take advantage of the <a class="reference external" href="https://en.wikipedia.org/wiki/ERuby">eRuby (Embedded Ruby)</a> templating system
in the <code class="docutils literal notranslate"><span class="pre">submit.yml.erb</span></code> file. You have access to all the
<a class="reference internal" href="form.html#app-development-interactive-form"><span class="std std-ref">User Form (form.yml.erb)</span></a> attributes.</p>
<p>For example, if you had a form attribute called <code class="docutils literal notranslate"><span class="pre">number_of_hours</span></code> that you
had the user fill out. You can add this to the submission parameters as such:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># ${HOME}/ondemand/dev/my_app/submit.yml.erb</span><span class="w"></span>
<span class="nn">---</span><span class="w"></span>
<span class="nt">batch_connect</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;basic&quot;</span><span class="w"></span>
<span class="nt">script</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">wall_time</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;%= (number_of_hours.blank? ? 1</span><span class="w"> </span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">number_of_hours.to_i) * 3600 %&gt;</span><span class="w"></span>
</pre></div>
</div>
<p>We have to be careful here, because all form attributes are returned as <a class="reference external" href="https://ruby-doc.org/core-2.2.3/String.html">Ruby
Strings</a>. So we need to:</p>
<ol class="arabic simple">
<li><p>First determine if the user filled in the attribute (check if it is
<code class="docutils literal notranslate"><span class="pre">#blank?</span></code>).</p></li>
<li><p>If they did, then we need to convert the string to an integer (<code class="docutils literal notranslate"><span class="pre">#to_i</span></code>)
before performing arithmetic operations on it.</p></li>
<li><p>Finally we convert hours to seconds.</p></li>
</ol>
<p>Another scenario would be if the user specified the queue directly with a
custom form attribute called <code class="docutils literal notranslate"><span class="pre">my_queue</span></code>. We can then add this user-supplied
queue conditionally to the submission parameters as such:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># ${HOME}/ondemand/dev/my_app/submit.yml.erb</span><span class="w"></span>
<span class="nn">---</span><span class="w"></span>
<span class="nt">batch_connect</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;basic&quot;</span><span class="w"></span>
<span class="nt">script</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">wall_time</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3600</span><span class="w"></span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">&lt;%- unless my_queue.blank? -%&gt;</span><span class="w"></span>
<span class="w">  </span><span class="nt">queue_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;%= my_queue %&gt;</span><span class="w"></span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">&lt;%- end -%&gt;</span><span class="w"></span>
<span class="w">  </span><span class="nt">email_on_started</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
</pre></div>
</div>
<p>In this case, <code class="docutils literal notranslate"><span class="pre">queue_name</span></code> will only be added to the submission parameters if
the user supplied a non-blank value to the form attribute <code class="docutils literal notranslate"><span class="pre">my_queue</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Most of the common form attributes that manipulate the job submission
parameters are provided for you as
<a class="reference internal" href="form.html#app-development-interactive-form-predefined-attributes"><span class="std std-ref">Predefined Attributes</span></a>. These
special attributes fill-in the <code class="docutils literal notranslate"><span class="pre">script</span></code> configuration options internally,
so you do not have to.</p>
<p>For example, if you used the predefined form attribute <code class="docutils literal notranslate"><span class="pre">bc_queue</span></code>, you do
not need to specify <code class="docutils literal notranslate"><span class="pre">queue_name:</span></code> in the <code class="docutils literal notranslate"><span class="pre">submit.yml.erb</span></code>.</p>
</div>
</div>
</div>
<div class="section" id="setting-batch-connect-options-globally">
<span id="global-bc-settings"></span><h2>Setting Batch Connect Options Globally<a class="headerlink" href="#setting-batch-connect-options-globally" title="Permalink to this headline">¶</a></h2>
<p>All of these configuration items can also be applied globally to the entire cluster
in the cluster definition files under <code class="docutils literal notranslate"><span class="pre">/etc/ood/config/clusters.d/</span></code>. If set globally,
the option is applied to all applications in that cluster.</p>
<p>Here’s an example of how to set the <code class="docutils literal notranslate"><span class="pre">header</span></code> configuration for both vnc and basic
templates.</p>
<blockquote>
<div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">v2</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">batch_connect</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">basic</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">header</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;#!/bin/bash&quot;</span><span class="w"></span>
<span class="w">    </span><span class="nt">vnc</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">header</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;#!/bin/bash&quot;</span><span class="w"></span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="view.html" class="btn btn-neutral float-right" title="Connection View" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="template.html" class="btn btn-neutral float-left" title="Render Template" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2023, Ohio Supercomputer Center

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Documentation Versions</span>
    v: 
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Versions</dt>
      
        <dd><a href="https://OSC.github.io/ood-documentation/latest/how-tos/app-development/interactive/submit.html">latest</a></dd>
      
        <dd><a href="https://OSC.github.io/ood-documentation/release-2.0/how-tos/app-development/interactive/submit.html">2.0</a></dd>
      
        <dd><a href="https://OSC.github.io/ood-documentation/release-1.8/how-tos/app-development/interactive/submit.html">1.8</a></dd>
      
        <dd><a href="https://OSC.github.io/ood-documentation/release-1.7/how-tos/app-development/interactive/submit.html">1.7</a></dd>
      
        <dd><a href="https://OSC.github.io/ood-documentation/release-1.6/how-tos/app-development/interactive/submit.html">1.6</a></dd>
      
        <dd><a href="https://OSC.github.io/ood-documentation/release-1.5/how-tos/app-development/interactive/submit.html">1.5</a></dd>
      
        <dd><a href="https://OSC.github.io/ood-documentation/release-1.4/how-tos/app-development/interactive/submit.html">1.4</a></dd>
      
        <dd><a href="https://OSC.github.io/ood-documentation/release-1.3/how-tos/app-development/interactive/submit.html">1.3</a></dd>
      
        <dd><a href="https://OSC.github.io/ood-documentation/release-1.2/how-tos/app-development/interactive/submit.html">1.2</a></dd>
      
        <dd><a href="https://OSC.github.io/ood-documentation/release-1.1/how-tos/app-development/interactive/submit.html">1.1</a></dd>
      
        <dd><a href="https://OSC.github.io/ood-documentation/release-1.0/how-tos/app-development/interactive/submit.html">1.0</a></dd>
      
        <dd><a href="https://OSC.github.io/ood-documentation/develop/how-tos/app-development/interactive/submit.html">develop</a></dd>
      
    </dl>
    <dl>
      <dt>On GitHub</dt>
        <dd>
          <a href="http://openondemand.org/">Website</a>
        </dd>
        <dd>
          <a href="https://github.com/OSC/Open-OnDemand">Main Repo</a>
        </dd>
    </dl>
    <hr/>
    Theme provided by <a href="http://www.readthedocs.org">Read the Docs</a>.
  </div>
</div>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>